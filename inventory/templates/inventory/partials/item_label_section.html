<!-- templates/inventory/partials/item_label_section.html -->
<div id="item-label-section-{{ item.id }}">
    <!-- Display existing labels -->
    <div class="flex flex-wrap gap-2 mt-2">
        {% for label in item.labels.all %}
            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm flex items-center">
                {{ label.name }}
                <button class="ml-1 text-blue-600 hover:text-blue-800"
                        hx-delete="{% url 'inventory:remove_label_from_item' item.id label.id %}"
                        hx-target="#item-label-section-{{ item.id }}">
                    Ã—
                </button>
            </span>
        {% endfor %}
    </div>

    <!-- Label controls -->
    <div class="flex items-center gap-2 mt-2">
        <!-- Quick Label Creation -->
        <form hx-post="{% url 'inventory:quick_create_label' item.id %}"
              hx-target="#item-label-section-{{ item.id }}"
              class="flex gap-2">
            {% csrf_token %}
            <input type="text" 
                   name="name"
                   placeholder="New label"
                   required
                   class="border rounded px-2 py-1 text-sm w-32">
            <button type="submit"
                    class="bg-green-500 text-white px-2 py-1 rounded text-sm">
                +
            </button>
        </form>

        <!-- Existing Labels Dropdown -->
        {% if all_labels %}
            <form hx-post="{% url 'inventory:add_label_to_item' item.id %}"
                hx-target="#item-label-section-{{ item.id }}"
                class="flex gap-2">
                {% csrf_token %}
                <select name="label_id" class="border rounded p-1 text-sm">
                    <option value="">Select label...</option>
                    {% for label in all_labels %}
                        {% if label not in item.labels.all %}
                            <option value="{{ label.id }}">{{ label.name }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <button type="submit"
                    class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">
                        Add
                </button>
            </form>
        {% endif %}
    </div>
</div>